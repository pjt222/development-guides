/**
 * colors.js - Theme palette system with 9 switchable colormaps
 *
 * Provides: getColor, setTheme, getCurrentPalette, getThemeNames
 * Backward compat: DOMAIN_COLORS Proxy delegates to active palette
 */

// ── Domain order (alphabetical) for consistent palette assignment ──
const DOMAIN_ORDER = [
  '3d-printing',
  'a2a-protocol',
  'alchemy',
  'animal-training',
  'blender',
  'bushcraft',
  'citations',
  'compliance',
  'containerization',
  'crafting',
  'data-serialization',
  'defensive',
  'design',
  'devops',
  'diffusion',
  'entomology',
  'esoteric',
  'gardening',
  'general',
  'geometry',
  'git',
  'hildegard',
  'intellectual-property',
  'jigsawr',
  'lapidary',
  'library-science',
  'linguistics',
  'maintenance',
  'mcp-integration',
  'mlops',
  'morphic',
  'mycology',
  'number-theory',
  'observability',
  'project-management',
  'prospecting',
  'r-packages',
  'relocation',
  'reporting',
  'review',
  'shiny',
  'stochastic-processes',
  'swarm',
  'tcg',
  'theoretical-science',
  'travel',
  'versioning',
  'visualization',
  'web-dev',
  'workflow-visualization',
];

// ── 9 named palettes: one hex color per domain (50 domains) ────────
const PALETTES = {
  cyberpunk: {
    '3d-printing':               '#55aadd',
    'a2a-protocol':              '#44bbaa',
    'alchemy':                   '#ffaa33',
    'animal-training':           '#ff9944',
    'blender':                   '#ee8833',
    'bushcraft':                 '#88cc44',
    'citations':                 '#66bbff',
    'compliance':                '#ff3366',
    'containerization':          '#44ddff',
    'crafting':                  '#cc8855',
    'data-serialization':        '#44aaff',
    'defensive':                 '#ff4444',
    'design':                    '#ff88dd',
    'devops':                    '#00ff88',
    'diffusion':                 '#cc77ff',
    'entomology':                '#77dd44',
    'esoteric':                  '#dd44ff',
    'gardening':                 '#44bb66',
    'general':                   '#ccccff',
    'geometry':                  '#55ccdd',
    'git':                       '#66ffcc',
    'hildegard':                 '#99bb44',
    'intellectual-property':     '#33ccff',
    'jigsawr':                   '#22ddaa',
    'lapidary':                  '#88ccee',
    'library-science':           '#8B7355',
    'linguistics':               '#cc99ff',
    'maintenance':               '#aabb88',
    'mcp-integration':           '#00ccaa',
    'mlops':                     '#aa66ff',
    'morphic':                   '#bb88ff',
    'mycology':                  '#aa77cc',
    'number-theory':             '#bbaaff',
    'observability':             '#ffaa00',
    'project-management':        '#ff8844',
    'prospecting':               '#ddaa33',
    'r-packages':                '#00f0ff',
    'relocation':                '#ff9977',
    'reporting':                 '#ffdd00',
    'review':                    '#ff66aa',
    'shiny':                     '#3399ff',
    'stochastic-processes':      '#77aaff',
    'swarm':                     '#aadd44',
    'tcg':                       '#ff5577',
    'theoretical-science':       '#ddbb55',
    'travel':                    '#66cc99',
    'versioning':                '#44ddaa',
    'visualization':             '#ee77cc',
    'web-dev':                   '#ff6633',
    'workflow-visualization':    '#66dd88',
  },

  viridis: {
    '3d-printing':               '#440154',
    'a2a-protocol':              '#46085C',
    'alchemy':                   '#471064',
    'animal-training':           '#48176A',
    'blender':                   '#481F70',
    'bushcraft':                 '#482576',
    'citations':                 '#472C7A',
    'compliance':                '#46337E',
    'containerization':          '#443983',
    'crafting':                  '#423F85',
    'data-serialization':        '#404588',
    'defensive':                 '#3E4A89',
    'design':                    '#3C508B',
    'devops':                    '#39568C',
    'diffusion':                 '#365C8D',
    'entomology':                '#34618D',
    'esoteric':                  '#31668E',
    'gardening':                 '#2F6B8E',
    'general':                   '#2D718E',
    'geometry':                  '#2B758E',
    'git':                       '#297A8E',
    'hildegard':                 '#277F8E',
    'intellectual-property':     '#25848E',
    'jigsawr':                   '#23898E',
    'lapidary':                  '#218E8D',
    'library-science':           '#20928C',
    'linguistics':               '#1F978B',
    'maintenance':               '#1E9D89',
    'mcp-integration':           '#1FA187',
    'mlops':                     '#21A685',
    'morphic':                   '#25AB82',
    'mycology':                  '#29AF7F',
    'number-theory':             '#30B57C',
    'observability':             '#38B977',
    'project-management':        '#40BD72',
    'prospecting':               '#4AC16D',
    'r-packages':                '#55C568',
    'relocation':                '#5FCA61',
    'reporting':                 '#6BCD5A',
    'review':                    '#77D153',
    'shiny':                     '#84D44B',
    'stochastic-processes':      '#91D742',
    'swarm':                     '#9FDA3A',
    'tcg':                       '#ACDC30',
    'theoretical-science':       '#BADE28',
    'travel':                    '#C8E020',
    'versioning':                '#D6E21A',
    'visualization':             '#E4E419',
    'web-dev':                   '#F1E51D',
    'workflow-visualization':    '#FDE725',
  },

  magma: {
    '3d-printing':               '#000004',
    'a2a-protocol':              '#02020B',
    'alchemy':                   '#050417',
    'animal-training':           '#0A0821',
    'blender':                   '#100B2D',
    'bushcraft':                 '#150E38',
    'citations':                 '#1C1045',
    'compliance':                '#231151',
    'containerization':          '#2B115E',
    'crafting':                  '#341069',
    'data-serialization':        '#3D0F71',
    'defensive':                 '#451077',
    'design':                    '#4E117B',
    'devops':                    '#57157E',
    'diffusion':                 '#5F187F',
    'entomology':                '#671B80',
    'esoteric':                  '#6E1E81',
    'gardening':                 '#772181',
    'general':                   '#7F2582',
    'geometry':                  '#882781',
    'git':                       '#902A81',
    'hildegard':                 '#982D80',
    'intellectual-property':     '#A02F7F',
    'jigsawr':                   '#AA337D',
    'lapidary':                  '#B2357B',
    'library-science':           '#BA3878',
    'linguistics':               '#C33B75',
    'maintenance':               '#CB3E71',
    'mcp-integration':           '#D3436E',
    'mlops':                     '#DB476A',
    'morphic':                   '#E24D66',
    'mycology':                  '#E85362',
    'number-theory':             '#EE5B5E',
    'observability':             '#F2645C',
    'project-management':        '#F66C5C',
    'prospecting':               '#F8765C',
    'r-packages':                '#FA805E',
    'relocation':                '#FC8A61',
    'reporting':                 '#FD9467',
    'review':                    '#FE9D6C',
    'shiny':                     '#FEA772',
    'stochastic-processes':      '#FEB179',
    'swarm':                     '#FEBA80',
    'tcg':                       '#FEC488',
    'theoretical-science':       '#FECD90',
    'travel':                    '#FED799',
    'versioning':                '#FDE1A2',
    'visualization':             '#FDEAAB',
    'web-dev':                   '#FCF4B6',
    'workflow-visualization':    '#FCFDBF',
  },

  inferno: {
    '3d-printing':               '#000004',
    'a2a-protocol':              '#02020C',
    'alchemy':                   '#050418',
    'animal-training':           '#0B0723',
    'blender':                   '#110A2F',
    'bushcraft':                 '#180C3C',
    'citations':                 '#1F0C49',
    'compliance':                '#280B54',
    'containerization':          '#320A5D',
    'crafting':                  '#3B0964',
    'data-serialization':        '#440A68',
    'defensive':                 '#4C0C6B',
    'design':                    '#540F6D',
    'devops':                    '#5D126E',
    'diffusion':                 '#65156E',
    'entomology':                '#6D186E',
    'esoteric':                  '#751B6E',
    'gardening':                 '#7E1E6D',
    'general':                   '#86216B',
    'geometry':                  '#8F2469',
    'git':                       '#972766',
    'hildegard':                 '#9F2A63',
    'intellectual-property':     '#A72E60',
    'jigsawr':                   '#AF315B',
    'lapidary':                  '#B73557',
    'library-science':           '#BF3952',
    'linguistics':               '#C63D4D',
    'maintenance':               '#CD4347',
    'mcp-integration':           '#D44842',
    'mlops':                     '#DA4E3C',
    'morphic':                   '#E05536',
    'mycology':                  '#E55C30',
    'number-theory':             '#EB6429',
    'observability':             '#EF6B23',
    'project-management':        '#F2741C',
    'prospecting':               '#F57D15',
    'r-packages':                '#F8860F',
    'relocation':                '#FA8F08',
    'reporting':                 '#FB9806',
    'review':                    '#FCA309',
    'shiny':                     '#FCAC11',
    'stochastic-processes':      '#FBB71B',
    'swarm':                     '#FAC127',
    'tcg':                       '#F9CB34',
    'theoretical-science':       '#F6D543',
    'travel':                    '#F4DF54',
    'versioning':                '#F2E967',
    'visualization':             '#F2F27B',
    'web-dev':                   '#F5F991',
    'workflow-visualization':    '#FCFFA4',
  },

  plasma: {
    '3d-printing':               '#0D0887',
    'a2a-protocol':              '#1B068D',
    'alchemy':                   '#270591',
    'animal-training':           '#300597',
    'blender':                   '#3A049A',
    'bushcraft':                 '#43039E',
    'citations':                 '#4B03A1',
    'compliance':                '#5402A3',
    'containerization':          '#5C01A6',
    'crafting':                  '#6400A7',
    'data-serialization':        '#6C00A8',
    'defensive':                 '#7401A8',
    'design':                    '#7C02A8',
    'devops':                    '#8405A7',
    'diffusion':                 '#8B0AA5',
    'entomology':                '#920FA3',
    'esoteric':                  '#99159F',
    'gardening':                 '#A11A9C',
    'general':                   '#A72197',
    'geometry':                  '#AD2793',
    'git':                       '#B32C8E',
    'hildegard':                 '#B93289',
    'intellectual-property':     '#BE3885',
    'jigsawr':                   '#C43E7F',
    'lapidary':                  '#C9447A',
    'library-science':           '#CD4A76',
    'linguistics':               '#D25071',
    'maintenance':               '#D7566C',
    'mcp-integration':           '#DB5C68',
    'mlops':                     '#DF6263',
    'morphic':                   '#E3685F',
    'mycology':                  '#E76E5B',
    'number-theory':             '#EB7557',
    'observability':             '#EE7B51',
    'project-management':        '#F1814D',
    'prospecting':               '#F48849',
    'r-packages':                '#F68F44',
    'relocation':                '#F9963F',
    'reporting':                 '#FA9E3B',
    'review':                    '#FCA537',
    'shiny':                     '#FDAC33',
    'stochastic-processes':      '#FDB42F',
    'swarm':                     '#FEBC2A',
    'tcg':                       '#FDC527',
    'theoretical-science':       '#FCCD25',
    'travel':                    '#FBD524',
    'versioning':                '#F9DE25',
    'visualization':             '#F6E726',
    'web-dev':                   '#F3F027',
    'workflow-visualization':    '#F0F921',
  },

  cividis: {
    '3d-printing':               '#00204D',
    'a2a-protocol':              '#002455',
    'alchemy':                   '#00275F',
    'animal-training':           '#002C68',
    'blender':                   '#002F6F',
    'bushcraft':                 '#00326F',
    'citations':                 '#02366E',
    'compliance':                '#16396D',
    'containerization':          '#223E6C',
    'crafting':                  '#2B416C',
    'data-serialization':        '#32456B',
    'defensive':                 '#39486B',
    'design':                    '#3F4D6B',
    'devops':                    '#45506B',
    'diffusion':                 '#4B546C',
    'entomology':                '#50576C',
    'esoteric':                  '#555B6D',
    'gardening':                 '#595F6D',
    'general':                   '#5F636E',
    'geometry':                  '#64666F',
    'git':                       '#686A71',
    'hildegard':                 '#6C6E72',
    'intellectual-property':     '#727174',
    'jigsawr':                   '#767676',
    'lapidary':                  '#7A7A78',
    'library-science':           '#7F7D78',
    'linguistics':               '#848179',
    'maintenance':               '#898579',
    'mcp-integration':           '#8E8A79',
    'mlops':                     '#938E78',
    'morphic':                   '#989278',
    'mycology':                  '#9D9677',
    'number-theory':             '#A39A76',
    'observability':             '#A99F75',
    'project-management':        '#AEA374',
    'prospecting':               '#B3A772',
    'r-packages':                '#B8AB70',
    'relocation':                '#BFAF6E',
    'reporting':                 '#C4B56C',
    'review':                    '#C9B96A',
    'shiny':                     '#CFBD67',
    'stochastic-processes':      '#D5C264',
    'swarm':                     '#DBC761',
    'tcg':                       '#E1CC5D',
    'theoretical-science':       '#E6D159',
    'travel':                    '#ECD555',
    'versioning':                '#F2DA50',
    'visualization':             '#F9E04A',
    'web-dev':                   '#FFE544',
    'workflow-visualization':    '#FFEA46',
  },

  mako: {
    '3d-printing':               '#03051A',
    'a2a-protocol':              '#08081E',
    'alchemy':                   '#100B23',
    'animal-training':           '#170F29',
    'blender':                   '#20122E',
    'bushcraft':                 '#271534',
    'citations':                 '#2E1739',
    'compliance':                '#36193E',
    'containerization':          '#3E1B43',
    'crafting':                  '#461C48',
    'data-serialization':        '#4E1D4B',
    'defensive':                 '#571E4F',
    'design':                    '#5F1F52',
    'devops':                    '#671F55',
    'diffusion':                 '#701F57',
    'entomology':                '#781F59',
    'esoteric':                  '#811E5A',
    'gardening':                 '#8A1E5B',
    'general':                   '#931C5B',
    'geometry':                  '#9C1B5B',
    'git':                       '#A4195B',
    'hildegard':                 '#AE1759',
    'intellectual-property':     '#B61657',
    'jigsawr':                   '#BE1654',
    'lapidary':                  '#C71951',
    'library-science':           '#CE1D4E',
    'linguistics':               '#D5234A',
    'maintenance':               '#DC2A46',
    'mcp-integration':           '#E13342',
    'mlops':                     '#E63B40',
    'morphic':                   '#EA443E',
    'mycology':                  '#ED4F3E',
    'number-theory':             '#EF5940',
    'observability':             '#F16345',
    'project-management':        '#F26D4B',
    'prospecting':               '#F37651',
    'r-packages':                '#F48059',
    'relocation':                '#F58961',
    'reporting':                 '#F59168',
    'review':                    '#F69B71',
    'shiny':                     '#F6A37A',
    'stochastic-processes':      '#F6AC84',
    'swarm':                     '#F6B48E',
    'tcg':                       '#F6BC99',
    'theoretical-science':       '#F7C4A4',
    'travel':                    '#F7CCAF',
    'versioning':                '#F8D3BB',
    'visualization':             '#F8DBC6',
    'web-dev':                   '#F9E3D2',
    'workflow-visualization':    '#FAEBDD',
  },

  rocket: {
    '3d-printing':               '#0B0405',
    'a2a-protocol':              '#11070C',
    'alchemy':                   '#160B14',
    'animal-training':           '#1C101B',
    'blender':                   '#211423',
    'bushcraft':                 '#26172B',
    'citations':                 '#2A1B34',
    'compliance':                '#2E1E3C',
    'containerization':          '#332344',
    'crafting':                  '#36274D',
    'data-serialization':        '#392B56',
    'defensive':                 '#3B2F5F',
    'design':                    '#3E3368',
    'devops':                    '#403871',
    'diffusion':                 '#413D7B',
    'entomology':                '#414184',
    'esoteric':                  '#40478B',
    'gardening':                 '#3F4C93',
    'general':                   '#3C5397',
    'geometry':                  '#3A599A',
    'git':                       '#385F9C',
    'hildegard':                 '#37659E',
    'intellectual-property':     '#366C9F',
    'jigsawr':                   '#3572A1',
    'lapidary':                  '#3578A2',
    'library-science':           '#357DA3',
    'linguistics':               '#3483A5',
    'maintenance':               '#3488A6',
    'mcp-integration':           '#348FA7',
    'mlops':                     '#3495A9',
    'morphic':                   '#349AAA',
    'mycology':                  '#35A0AB',
    'number-theory':             '#37A5AC',
    'observability':             '#39ACAC',
    'project-management':        '#3CB2AD',
    'prospecting':               '#40B7AD',
    'r-packages':                '#45BDAD',
    'relocation':                '#4CC3AD',
    'reporting':                 '#53C9AD',
    'review':                    '#5ECDAD',
    'shiny':                     '#6AD2AD',
    'stochastic-processes':      '#7AD6AE',
    'swarm':                     '#8AD9B1',
    'tcg':                       '#98DDB6',
    'theoretical-science':       '#A6E1BC',
    'travel':                    '#B3E4C2',
    'versioning':                '#BFE8CB',
    'visualization':             '#C9EDD3',
    'web-dev':                   '#D4F1DC',
    'workflow-visualization':    '#DEF5E5',
  },

  turbo: {
    '3d-printing':               '#30123B',
    'a2a-protocol':              '#362260',
    'alchemy':                   '#3B3083',
    'animal-training':           '#3F3FA0',
    'blender':                   '#434DB9',
    'bushcraft':                 '#455CCF',
    'citations':                 '#466AE1',
    'compliance':                '#4777EF',
    'containerization':          '#4684F9',
    'crafting':                  '#4391FE',
    'data-serialization':        '#3D9EFE',
    'defensive':                 '#34ACF8',
    'design':                    '#2BB8EF',
    'devops':                    '#22C4E3',
    'diffusion':                 '#1BD0D5',
    'entomology':                '#18D9C8',
    'esoteric':                  '#19E2BB',
    'gardening':                 '#20EAAD',
    'general':                   '#2BF09F',
    'geometry':                  '#3CF58E',
    'git':                       '#4EF97D',
    'hildegard':                 '#62FC6B',
    'intellectual-property':     '#77FE5B',
    'jigsawr':                   '#8AFF4C',
    'lapidary':                  '#9CFE40',
    'library-science':           '#A9FB39',
    'linguistics':               '#B8F735',
    'maintenance':               '#C5F034',
    'mcp-integration':           '#D2E935',
    'mlops':                     '#DDE037',
    'morphic':                   '#E7D739',
    'mycology':                  '#F0CC3A',
    'number-theory':             '#F7C23A',
    'observability':             '#FBB737',
    'project-management':        '#FEA933',
    'prospecting':               '#FE9B2D',
    'r-packages':                '#FD8C27',
    'relocation':                '#FB7C20',
    'reporting':                 '#F66D19',
    'review':                    '#F15D13',
    'shiny':                     '#EB500E',
    'stochastic-processes':      '#E3440A',
    'swarm':                     '#DB3A07',
    'tcg':                       '#D02F05',
    'theoretical-science':       '#C52603',
    'travel':                    '#B91E02',
    'versioning':                '#AB1701',
    'visualization':             '#9C0F01',
    'web-dev':                   '#8C0902',
    'workflow-visualization':    '#7A0403',
  },
};

// ── Active theme state ──────────────────────────────────────────────
let currentTheme = 'cyberpunk';

export function getColor(domain) {
  return PALETTES[currentTheme]?.[domain] || '#ffffff';
}

export function setTheme(name) {
  if (PALETTES[name]) {
    currentTheme = name;
  }
}

export function getCurrentPalette() {
  return { ...PALETTES[currentTheme] };
}

export function getThemeNames() {
  return Object.keys(PALETTES);
}

export function getCurrentThemeName() {
  return currentTheme;
}

// ── Backward-compatible DOMAIN_COLORS Proxy ─────────────────────────
// Existing code reads DOMAIN_COLORS[domain]; this Proxy delegates to
// the active palette so theme switches propagate without code changes.
export const DOMAIN_COLORS = new Proxy({}, {
  get(_target, prop) {
    if (typeof prop === 'string') {
      return PALETTES[currentTheme]?.[prop];
    }
    return undefined;
  },
  ownKeys() {
    return DOMAIN_ORDER;
  },
  getOwnPropertyDescriptor(_target, prop) {
    if (DOMAIN_ORDER.includes(prop)) {
      return { configurable: true, enumerable: true, value: PALETTES[currentTheme]?.[prop] };
    }
    return undefined;
  },
  has(_target, prop) {
    return DOMAIN_ORDER.includes(prop);
  },
});

// ── Per-agent per-palette colors ─────────────────────────────────
const AGENT_PALETTE_COLORS = {
  cyberpunk: {
    'acp-developer':                 '#55ddbb',
    'advocatus-diaboli':             '#ff4433',
    'alchemist':                     '#ffaa33',
    'apa-specialist':                '#77aadd',
    'auditor':                       '#ff7744',
    'blender-artist':                '#ff8833',
    'code-reviewer':                 '#ff66aa',
    'designer':                      '#ff88dd',
    'devops-engineer':               '#00ff88',
    'diffusion-specialist':          '#cc77ff',
    'dog-trainer':                   '#ff9944',
    'etymologist':                   '#ddbb66',
    'fabricator':                    '#55ccdd',
    'gardener':                      '#44bb66',
    'geometrist':                    '#44ffaa',
    'gxp-validator':                 '#ff3399',
    'hiking-guide':                  '#77cc55',
    'hildegard':                     '#88dd77',
    'ip-analyst':                    '#33ccff',
    'janitor':                       '#99aacc',
    'jigsawr-developer':             '#22ddaa',
    'kabalist':                      '#9966dd',
    'lapidary':                      '#88ccee',
    'librarian':                     '#8B7355',
    'markovian':                     '#7799ff',
    'martial-artist':                '#ff4466',
    'mcp-developer':                 '#00ddbb',
    'mlops-engineer':                '#bb77ff',
    'mycologist':                    '#aa77cc',
    'mystic':                        '#dd44ff',
    'nlp-specialist':                '#bb88ff',
    'number-theorist':               '#bbaaff',
    'polymath':                      '#eedd44',
    'project-manager':               '#ff8844',
    'prospector':                    '#ddaa33',
    'putior-integrator':             '#66dd88',
    'quarto-developer':              '#33ddcc',
    'r-developer':                   '#00f0ff',
    'relocation-expert':             '#ffbb44',
    'security-analyst':              '#ff3333',
    'senior-data-scientist':         '#aa66ff',
    'senior-researcher':             '#ffaa00',
    'senior-software-developer':     '#44ddff',
    'senior-ux-ui-specialist':       '#66ffcc',
    'senior-web-designer':           '#ffdd00',
    'shaman':                        '#9944ff',
    'shapeshifter':                  '#bb88ff',
    'shiny-developer':               '#3399ff',
    'skill-reviewer':                '#ff66bb',
    'survivalist':                   '#88cc44',
    'swarm-strategist':              '#aadd44',
    'tcg-specialist':                '#ff5577',
    'theoretical-researcher':        '#aabbff',
    'tour-planner':                  '#ffaa55',
    'version-manager':               '#44ddaa',
    'web-developer':                 '#ff6633',
  },

  viridis: {
    'auditor':                       '#482576',
    'code-reviewer':                 '#46307E',
    'designer':                      '#433D84',
    'dog-trainer':                   '#888888',
    'devops-engineer':               '#3F4889',
    'gxp-validator':                 '#3B528B',
    'jigsawr-developer':             '#365D8D',
    'librarian':                     '#888888',
    'martial-artist':                '#31678E',
    'mlops-engineer':                '#2D718E',
    'mycologist':                    '#888888',
    'mystic':                        '#29798E',
    'project-manager':               '#26828E',
    'prospector':                    '#888888',
    'putior-integrator':             '#228C8D',
    'r-developer':                   '#1F948C',
    'security-analyst':              '#1F9E89',
    'shiny-developer':               '#20A387',
    'senior-data-scientist':         '#22A785',
    'senior-researcher':             '#29AF7F',
    'senior-software-developer':     '#37B878',
    'senior-ux-ui-specialist':       '#48C16E',
    'senior-web-designer':           '#5BC863',
    'shaman':                        '#888888',
    'shapeshifter':                  '#71CF57',
    'survivalist':                   '#89D548',
    'swarm-strategist':              '#A2DA37',
    'web-developer':                 '#BBDF27',
  },

  magma: {
    'auditor':                       '#150E37',
    'code-reviewer':                 '#21114E',
    'designer':                      '#311165',
    'dog-trainer':                   '#888888',
    'devops-engineer':               '#410F75',
    'gxp-validator':                 '#51127C',
    'jigsawr-developer':             '#601880',
    'librarian':                     '#888888',
    'martial-artist':                '#6F1F81',
    'mlops-engineer':                '#7F2582',
    'mycologist':                    '#888888',
    'mystic':                        '#8F2A81',
    'project-manager':               '#9E2F7F',
    'prospector':                    '#888888',
    'putior-integrator':             '#AE347B',
    'r-developer':                   '#BE3977',
    'security-analyst':              '#CD4071',
    'shiny-developer':               '#D5446D',
    'senior-data-scientist':         '#DC4869',
    'senior-researcher':             '#E85362',
    'senior-software-developer':     '#F2625D',
    'senior-ux-ui-specialist':       '#F8745C',
    'senior-web-designer':           '#FB8661',
    'shaman':                        '#888888',
    'shapeshifter':                  '#FD9969',
    'survivalist':                   '#FEAA74',
    'swarm-strategist':              '#FEBD82',
    'web-developer':                 '#FECE91',
  },

  inferno: {
    'auditor':                       '#170C3A',
    'code-reviewer':                 '#260C51',
    'designer':                      '#380962',
    'dog-trainer':                   '#888888',
    'devops-engineer':               '#480B6A',
    'gxp-validator':                 '#58106E',
    'jigsawr-developer':             '#67166E',
    'librarian':                     '#888888',
    'martial-artist':                '#771C6D',
    'mlops-engineer':                '#86216B',
    'mycologist':                    '#888888',
    'mystic':                        '#962667',
    'project-manager':               '#A52C60',
    'prospector':                    '#888888',
    'putior-integrator':             '#B43359',
    'r-developer':                   '#C23A50',
    'security-analyst':              '#CF4446',
    'shiny-developer':               '#D54A40',
    'senior-data-scientist':         '#DB503B',
    'senior-researcher':             '#E65D30',
    'senior-software-developer':     '#EE6A24',
    'senior-ux-ui-specialist':       '#F57B17',
    'senior-web-designer':           '#F98C0A',
    'shaman':                        '#888888',
    'shapeshifter':                  '#FB9E07',
    'survivalist':                   '#FCB014',
    'swarm-strategist':              '#FAC429',
    'web-developer':                 '#F6D645',
  },

  plasma: {
    'auditor':                       '#42049E',
    'code-reviewer':                 '#5102A3',
    'designer':                      '#6100A7',
    'dog-trainer':                   '#888888',
    'devops-engineer':               '#7000A8',
    'gxp-validator':                 '#7F03A8',
    'jigsawr-developer':             '#8D0BA5',
    'librarian':                     '#888888',
    'martial-artist':                '#9A169F',
    'mlops-engineer':                '#A62098',
    'mycologist':                    '#888888',
    'mystic':                        '#B22B8F',
    'project-manager':               '#BD3786',
    'prospector':                    '#888888',
    'putior-integrator':             '#C7427C',
    'r-developer':                   '#CF4C74',
    'security-analyst':              '#D8576B',
    'shiny-developer':               '#DC5D67',
    'senior-data-scientist':         '#E06363',
    'senior-researcher':             '#E76F5B',
    'senior-software-developer':     '#ED7A52',
    'senior-ux-ui-specialist':       '#F3874A',
    'senior-web-designer':           '#F89441',
    'shaman':                        '#888888',
    'shapeshifter':                  '#FBA139',
    'survivalist':                   '#FDAF31',
    'swarm-strategist':              '#FEBE2A',
    'web-developer':                 '#FCCE25',
  },

  cividis: {
    'auditor':                       '#00326F',
    'code-reviewer':                 '#13386D',
    'designer':                      '#28406C',
    'dog-trainer':                   '#888888',
    'devops-engineer':               '#36476B',
    'gxp-validator':                 '#414D6B',
    'jigsawr-developer':             '#4C546C',
    'librarian':                     '#888888',
    'martial-artist':                '#565C6D',
    'mlops-engineer':                '#5F636E',
    'mycologist':                    '#888888',
    'mystic':                        '#676970',
    'project-manager':               '#707173',
    'prospector':                    '#888888',
    'putior-integrator':             '#787877',
    'r-developer':                   '#817F79',
    'security-analyst':              '#8A8779',
    'shiny-developer':               '#8F8B78',
    'senior-data-scientist':         '#948E78',
    'senior-researcher':             '#9E9677',
    'senior-software-developer':     '#A89E75',
    'senior-ux-ui-specialist':       '#B2A672',
    'senior-web-designer':           '#BCAF6F',
    'shaman':                        '#888888',
    'shapeshifter':                  '#C6B66B',
    'survivalist':                   '#D1BF66',
    'swarm-strategist':              '#DCC860',
    'web-developer':                 '#E7D159',
  },

  mako: {
    'auditor':                       '#261433',
    'code-reviewer':                 '#34193D',
    'designer':                      '#431C46',
    'dog-trainer':                   '#888888',
    'devops-engineer':               '#521E4D',
    'gxp-validator':                 '#621F53',
    'jigsawr-developer':             '#711F57',
    'librarian':                     '#888888',
    'martial-artist':                '#821E5A',
    'mlops-engineer':                '#931C5B',
    'mycologist':                    '#888888',
    'mystic':                        '#A3195B',
    'project-manager':               '#B41658',
    'prospector':                    '#888888',
    'putior-integrator':             '#C31753',
    'r-developer':                   '#D11F4C',
    'security-analyst':              '#DD2C45',
    'shiny-developer':               '#E23442',
    'senior-data-scientist':         '#E73D3F',
    'senior-researcher':             '#ED4F3E',
    'senior-software-developer':     '#F16244',
    'senior-ux-ui-specialist':       '#F37450',
    'senior-web-designer':           '#F4855E',
    'shaman':                        '#888888',
    'shapeshifter':                  '#F5966D',
    'survivalist':                   '#F6A67E',
    'swarm-strategist':              '#F6B591',
    'web-developer':                 '#F7C5A5',
  },

  rocket: {
    'auditor':                       '#26172A',
    'code-reviewer':                 '#2E1E39',
    'designer':                      '#35254A',
    'dog-trainer':                   '#888888',
    'devops-engineer':               '#3B2D5A',
    'gxp-validator':                 '#3E356C',
    'jigsawr-developer':             '#413E7D',
    'librarian':                     '#888888',
    'martial-artist':                '#40488D',
    'mlops-engineer':                '#3D5297',
    'mycologist':                    '#888888',
    'mystic':                        '#395E9C',
    'project-manager':               '#366A9F',
    'prospector':                    '#888888',
    'putior-integrator':             '#3575A1',
    'r-developer':                   '#347FA4',
    'security-analyst':              '#348BA6',
    'shiny-developer':               '#3490A8',
    'senior-data-scientist':         '#3496A9',
    'senior-researcher':             '#35A1AB',
    'senior-software-developer':     '#39ABAC',
    'senior-ux-ui-specialist':       '#3FB6AD',
    'senior-web-designer':           '#49C1AD',
    'shaman':                        '#888888',
    'shapeshifter':                  '#58CBAD',
    'survivalist':                   '#70D4AD',
    'swarm-strategist':              '#8DDBB3',
    'web-developer':                 '#A8E1BC',
  },

  turbo: {
    'auditor':                       '#455BCD',
    'code-reviewer':                 '#4774EC',
    'designer':                      '#458CFD',
    'dog-trainer':                   '#888888',
    'devops-engineer':               '#39A4FB',
    'gxp-validator':                 '#28BDEA',
    'jigsawr-developer':             '#1AD2D2',
    'librarian':                     '#888888',
    'martial-artist':                '#19E3BA',
    'mlops-engineer':                '#2BEFA0',
    'mycologist':                    '#888888',
    'mystic':                        '#4BF87F',
    'project-manager':               '#71FE5F',
    'prospector':                    '#888888',
    'putior-integrator':             '#95FE45',
    'r-developer':                   '#B0FA37',
    'security-analyst':              '#C8EF34',
    'shiny-developer':               '#D4E736',
    'senior-data-scientist':         '#DFDF37',
    'senior-researcher':             '#F0CC3A',
    'senior-software-developer':     '#FBB838',
    'senior-ux-ui-specialist':       '#FE9E2F',
    'senior-web-designer':           '#FB8222',
    'shaman':                        '#888888',
    'shapeshifter':                  '#F46516',
    'survivalist':                   '#E84B0C',
    'swarm-strategist':              '#D83706',
    'web-developer':                 '#C42503',
  },
};

export function getAgentColor(agentId) {
  if (agentId && AGENT_PALETTE_COLORS[currentTheme]?.[agentId]) {
    return AGENT_PALETTE_COLORS[currentTheme][agentId];
  }
  // Fallback: first agent color in current palette, or gold
  const colors = AGENT_PALETTE_COLORS[currentTheme];
  if (colors) {
    const vals = Object.values(colors);
    return vals[0] || '#ffd700';
  }
  return '#ffd700';
}

export const AGENT_PRIORITY_CONFIG = {
  critical: { radius: 8, glowRadius: 24, glowOpacity: 0.7 },
  high:     { radius: 6, glowRadius: 18, glowOpacity: 0.5 },
  normal:   { radius: 5, glowRadius: 14, glowOpacity: 0.4 },
};

// ── Per-team per-palette colors ──────────────────────────────────
const TEAM_PALETTE_COLORS = {
  cyberpunk: {
    'agentskills-alignment':         '#ff66bb',
    'ai-self-care':                  '#da70d6',
    'devops-platform-engineering':   '#ff4500',
    'entomology':                    '#77dd44',
    'fullstack-web-dev':             '#ffcc00',
    'gxp-compliance-validation':     '#ff6ec7',
    'ml-data-science-review':        '#7b68ee',
    'opaque-team':                   '#bb88ff',
    'r-package-review':              '#00ccff',
    'scrum-team':                    '#ff8844',
  },

  viridis: {
    'agentskills-alignment':         '#35608D',
    'ai-self-care':                  '#2F6B8E',
    'devops-platform-engineering':   '#2B758E',
    'entomology':                    '#27808E',
    'fullstack-web-dev':             '#228B8D',
    'gxp-compliance-validation':     '#1F958B',
    'ml-data-science-review':        '#1FA188',
    'opaque-team':                   '#25AB82',
    'r-package-review':              '#31B57B',
    'scrum-team':                    '#43BF71',
  },

  magma: {
    'agentskills-alignment':         '#641A80',
    'ai-self-care':                  '#762181',
    'devops-platform-engineering':   '#882781',
    'entomology':                    '#9A2D7F',
    'fullstack-web-dev':             '#AD347C',
    'gxp-compliance-validation':     '#BF3A77',
    'ml-data-science-review':        '#D1426F',
    'opaque-team':                   '#E24D66',
    'r-package-review':              '#EE5B5E',
    'scrum-team':                    '#F76F5C',
  },

  inferno: {
    'agentskills-alignment':         '#6B186E',
    'ai-self-care':                  '#7D1E6D',
    'devops-platform-engineering':   '#8F2469',
    'entomology':                    '#A12A63',
    'fullstack-web-dev':             '#B3325A',
    'gxp-compliance-validation':     '#C33B4F',
    'ml-data-science-review':        '#D34744',
    'opaque-team':                   '#E05536',
    'r-package-review':              '#EB6429',
    'scrum-team':                    '#F3771A',
  },

  plasma: {
    'agentskills-alignment':         '#900DA4',
    'ai-self-care':                  '#A01A9C',
    'devops-platform-engineering':   '#AD2793',
    'entomology':                    '#BB3488',
    'fullstack-web-dev':             '#C6417D',
    'gxp-compliance-validation':     '#D04D73',
    'ml-data-science-review':        '#DA5B6A',
    'opaque-team':                   '#E3685F',
    'r-package-review':              '#EB7556',
    'scrum-team':                    '#F1844B',
  },

  cividis: {
    'agentskills-alignment':         '#4E576C',
    'ai-self-care':                  '#595F6D',
    'devops-platform-engineering':   '#64666F',
    'entomology':                    '#6E6E73',
    'fullstack-web-dev':             '#787777',
    'gxp-compliance-validation':     '#828079',
    'ml-data-science-review':        '#8C8879',
    'opaque-team':                   '#989278',
    'r-package-review':              '#A39A76',
    'scrum-team':                    '#B0A473',
  },

  mako: {
    'agentskills-alignment':         '#751F58',
    'ai-self-care':                  '#891E5B',
    'devops-platform-engineering':   '#9C1B5B',
    'entomology':                    '#AF1759',
    'fullstack-web-dev':             '#C21753',
    'gxp-compliance-validation':     '#D2204C',
    'ml-data-science-review':        '#DF3044',
    'opaque-team':                   '#EA443E',
    'r-package-review':              '#EF5A41',
    'scrum-team':                    '#F2704D',
  },

  rocket: {
    'agentskills-alignment':         '#414081',
    'ai-self-care':                  '#3F4C92',
    'devops-platform-engineering':   '#3A599A',
    'entomology':                    '#37679F',
    'fullstack-web-dev':             '#3574A1',
    'gxp-compliance-validation':     '#3480A4',
    'ml-data-science-review':        '#348EA7',
    'opaque-team':                   '#349AAA',
    'r-package-review':              '#37A6AC',
    'scrum-team':                    '#3DB4AD',
  },

  turbo: {
    'agentskills-alignment':         '#18D6CB',
    'ai-self-care':                  '#1FE9B0',
    'devops-platform-engineering':   '#3DF58D',
    'entomology':                    '#67FD68',
    'fullstack-web-dev':             '#91FF47',
    'gxp-compliance-validation':     '#B1F936',
    'ml-data-science-review':        '#CEEB34',
    'opaque-team':                   '#E7D739',
    'r-package-review':              '#F7C13A',
    'scrum-team':                    '#FEA632',
  },
};

export function getTeamColor(teamId) {
  if (teamId && TEAM_PALETTE_COLORS[currentTheme]?.[teamId]) {
    return TEAM_PALETTE_COLORS[currentTheme][teamId];
  }
  const colors = TEAM_PALETTE_COLORS[currentTheme];
  if (colors) {
    const vals = Object.values(colors);
    return vals[0] || '#00ffcc';
  }
  return '#00ffcc';
}

export const TEAM_CONFIG = {
  radius: 7,
  glowRadius: 20,
  glowOpacity: 0.55,
};

// ── Complexity configs (unchanged) ──────────────────────────────────
export const COMPLEXITY_CONFIG = {
  basic:        { radius: 5, glowRadius: 14, glowOpacity: 0.4,  label: 'Basic' },
  intermediate: { radius: 5, glowRadius: 18, glowOpacity: 0.5,  label: 'Intermediate' },
  advanced:     { radius: 5, glowRadius: 22, glowOpacity: 0.6,  label: 'Advanced' },
};

export const COMPLEXITY_BADGE_COLORS = {
  basic:        '#00ff88',
  intermediate: '#ffdd00',
  advanced:     '#dd44ff',
};

// ── Featured hub nodes (viz-layer config, not skill metadata) ────────
export const FEATURED_NODES = {
  'create-skill':        { radius: 9, tier: 'primary' },
  'evolve-skill':        { radius: 7, tier: 'secondary' },
  'create-skill-glyph':  { radius: 7, tier: 'secondary' },
};

const _rgbaCache = new Map();
export function hexToRgba(hex, alpha) {
  const key = hex + '|' + alpha;
  let val = _rgbaCache.get(key);
  if (val !== undefined) return val;
  const r = parseInt(hex.slice(1, 3), 16);
  const g = parseInt(hex.slice(3, 5), 16);
  const b = parseInt(hex.slice(5, 7), 16);
  val = `rgba(${r},${g},${b},${alpha})`;
  _rgbaCache.set(key, val);
  return val;
}
